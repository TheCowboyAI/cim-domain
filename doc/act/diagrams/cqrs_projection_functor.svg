<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 980 520" width="980" height="520">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,3 L0,6 Z" fill="#374151" />
    </marker>
    <style><![CDATA[
      .evt { fill: #fef3c7; stroke: #b45309; stroke-width: 1.2; rx: 8; ry: 8; }
      .rm  { fill: #eef2ff; stroke: #3730a3; stroke-width: 1.2; rx: 8; ry: 8; }
      .label { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; font-size: 14px; fill: #111827; }
      .title { font-size: 18px; font-weight: 600; }
      .edge { stroke: #374151; stroke-width: 1.6; fill: none; marker-end: url(#arrow); }
    ]]></style>
  </defs>

  <text x="20" y="28" class="label title">CQRS Projection as a Functor P: Events → ReadModel</text>

  <rect x="60" y="80" width="240" height="64" class="evt" />
  <text x="80" y="118" class="label">DomainEvent</text>

  <rect x="360" y="80" width="240" height="64" class="rm" />
  <text x="380" y="118" class="label">Projection (projections::Projection)</text>

  <rect x="660" y="80" width="240" height="64" class="rm" />
  <text x="680" y="118" class="label">ReadModel</text>

  <path class="edge" d="M300,112 C320,112 340,112 360,112" />
  <text x="300" y="100" class="label">P</text>

  <path class="edge" d="M600,112 C620,112 640,112 660,112" />
  <text x="600" y="100" class="label">update</text>

  <text x="60" y="200" class="label">Functoriality: P(e2 ∘ e1) = P(e2) ∘ P(e1)</text>

  <rect x="60" y="260" width="240" height="64" class="rm" />
  <text x="80" y="298" class="label">ReadModel</text>

  <rect x="360" y="260" width="240" height="64" class="rm" />
  <text x="380" y="298" class="label">Query</text>

  <rect x="660" y="260" width="240" height="64" class="rm" />
  <text x="680" y="298" class="label">QueryResponse</text>

  <path class="edge" d="M300,292 C320,292 340,292 360,292" />
  <text x="300" y="280" class="label">ask</text>

  <path class="edge" d="M600,292 C620,292 640,292 660,292" />
  <text x="600" y="280" class="label">answer</text>
</svg>
