<svg xmlns="http://www.w3.org/2000/svg" width="1024" height="380" viewBox="0 0 1024 380">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,3 L0,6 Z" fill="#374151" />
    </marker>
    <style><![CDATA[
      .title { font-family: ui-sans-serif, system-ui; font-size: 18px; font-weight: 600; fill: #111827; }
      .label { font-family: ui-sans-serif, system-ui; font-size: 13px; fill: #111827; }
      .cmd { fill: #fffbeb; stroke: #f59e0b; stroke-width: 1.2; rx: 8; ry: 8; }
      .agg { fill: #f0f9ff; stroke: #0ea5e9; stroke-width: 1.6; rx: 12; ry: 12; }
      .evt { fill: #fff1f2; stroke: #f43f5e; stroke-width: 1.2; rx: 8; ry: 8; }
      .env { fill: #f5f3ff; stroke: #7c3aed; stroke-width: 1.2; rx: 8; ry: 8; }
      .stream { fill: #f3f4f6; stroke: #6b7280; stroke-width: 1.2; rx: 8; ry: 8; }
      .cid { fill: #f4f4f5; stroke: #71717a; stroke-width: 1.2; rx: 8; ry: 8; }
      .edge { stroke: #374151; stroke-width: 1.3; fill: none; marker-end: url(#arrow); }
    ]]></style>
  </defs>

  <text x="16" y="28" class="title">Event Pipeline</text>

  <rect x="40" y="100" width="140" height="46" class="cmd" />
  <text x="54" y="128" class="label">Command</text>
  <rect x="220" y="80" width="200" height="120" class="agg" />
  <text x="232" y="100" class="label">AggregateRoot</text>
  <path class="edge" d="M180,123 C192,123 206,123 220,123" />
  <text x="170" y="112" class="label">handled_by</text>

  <rect x="470" y="100" width="160" height="46" class="evt" />
  <text x="482" y="128" class="label">DomainEvent</text>
  <path class="edge" d="M420,120 C430,120 440,120 470,120" />
  <text x="405" y="110" class="label">emits_event</text>
  <text x="280" y="70" class="label">causes_event</text>

  <rect x="670" y="60" width="200" height="46" class="env" />
  <text x="682" y="88" class="label">DomainEventEnvelope</text>
  <path class="edge" d="M630,120 C642,102 658,90 670,82" />
  <text x="640" y="104" class="label">wraps_event</text>

  <rect x="670" y="120" width="140" height="40" class="cid" />
  <text x="682" y="144" class="label">DomainCid</text>
  <path class="edge" d="M750,106 C750,112 750,116 750,120" />
  <text x="758" y="114" class="label">payload_cid</text>

  <rect x="900" y="100" width="120" height="46" class="stream" />
  <text x="912" y="128" class="label">EventStream</text>
  <path class="edge" d="M770,106 C820,106 850,106 900,106" />
  <text x="820" y="96" class="label">appended_to_stream</text>
  <path class="edge" d="M900,146 C860,180 800,180 750,146" />
  <text x="820" y="170" class="label">stream_contains_envelope</text>

</svg>

