<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 980 520" width="980" height="520">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,3 L0,6 Z" fill="#374151" />
    </marker>
    <style><![CDATA[
      .box { fill: #f8fafc; stroke: #1f2937; stroke-width: 1.2; rx: 8; ry: 8; }
      .mono { stroke: #16a34a; stroke-dasharray: 6 4; stroke-width: 1.6; }
      .label { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; font-size: 14px; fill: #111827; }
      .title { font-size: 18px; font-weight: 600; }
      .edge { stroke: #374151; stroke-width: 1.6; fill: none; marker-end: url(#arrow); }
    ]]></style>
  </defs>

  <text x="20" y="28" class="label title">Guarded Command as Pullback (domain restriction)</text>

  <rect x="80" y="120" width="260" height="64" class="box" />
  <text x="100" y="158" class="label">S_allowed ⊆ ProjectAggregate</text>

  <rect x="400" y="120" width="260" height="64" class="box" />
  <text x="420" y="158" class="label">ProjectAggregate</text>

  <rect x="720" y="120" width="180" height="64" class="box" />
  <text x="740" y="158" class="label">Ω</text>

  <path class="edge mono" d="M340,152 C360,152 380,152 400,152" />
  <text x="260" y="140" class="label">i: mono</text>

  <path class="edge" d="M660,152 C680,152 700,152 720,152" />
  <text x="570" y="140" class="label">χ_guard</text>

  <rect x="80" y="240" width="260" height="64" class="box" />
  <text x="100" y="278" class="label">handle|_{S_allowed}</text>

  <rect x="400" y="240" width="260" height="64" class="box" />
  <text x="420" y="278" class="label">handle</text>

  <path class="edge" d="M210,184 C210,200 210,224 210,240" />
  <path class="edge" d="M530,184 C530,200 530,224 530,240" />
  <text x="260" y="220" class="label">pullback square</text>

</svg>
